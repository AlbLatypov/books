# Глава 2. Сценарии: начало

>Playbook = сценарий

Устаревшие записи плейбуков, без Fully Qualified Collection Name (FQCN), но уже с become и больше похоже на реалии, чем в предыдущей книге Ansible for devops

### Группы в инвентори

>Пока довольно категорично говорится о том, что могут только ini. __YAML был в ansible 2.3?__ Ну конечно был, если ПБ на нем, почему тогда инвентори только INI?

[webservers]
testserver ansible_host=127.0.0.1 ansible_port=2222

>Предлагает делать в строчку. Я все таки переношу...

### YAML
 - Начинаются с `---` но не беда, если не укажете.
 - можно комментировать #

Про отступы ни слова.

__Списки:__

или через дефисы или классически по питонски [a,b,c]

__Словари__

python

__Объединение строк:__

В YAML для этого можно воспользоваться знаком «больше»(>). Парсер YAMLв этом случае заменит разрывы строк пробелами. Например:
__addгess: >__
Departмent of Сомрutег Science,
A.V. Williaмs Building,
University of Maryland
city: College Рагk
state: Maryland

далее классиеческая структура

### Таски или задачи

> парамент __name__ не является обязательным

Понятно. Видимо в предыщущих версиях еще парсинг был по другому организован и для записи с новых строк надо было писать так:

паме: install nginx
__apt: >__
naмe=nginx
update_cache=yes

Сейчас уже не надо так.

### Модули

Перевод верный, пример ansible.builtin.file module и других

`ansible-doc service`

а я читаю в интернете. Проверить. Не работает.

### Handlers

handlers:
- nаmе: restart nginx

notify: restart nginx

_Несколько фактов об обработчиках,
которые необходимо помнить_

Обработчики выполняются только после завершения всех задач и только один раз, даже если было получено несколько. Они всегда выполняются в порядке следования в разделе handlers, а не в порядке поступления уведомлений. В официальной документации AnsiЬle говорится, что обработчики в основ­
ном используются для перезапуска служб и перезагрузки. Лично я использую их исключительно для перезапуска служб. Надо сказать, что это не дает особой выгоды, потому что перезапуск службы всегда можно организовать в конце сценария и обойтись без использования уведомлений.
Другое неудобство обработчиков состоит в том, что они могут создавать сложности при отладке сценария, например:
1. Я запускаю сценарий.
2. Одна из задач с уведомлением изменяет состояние.
3. В следующей задаче возникает ошибка, прерывающая работу AnsiЫe.
4. Я исправляю ошибку в сценарии.
5. Запускаю AnsiЫe снова.
6. Ни одна из задач не сообщает об изменении состояния во второй раз,
Ansible не запускает обработчика.
